% Template for ICASSP-2021 paper; to be used with:
%          spconf.sty  - ICASSP/ICIP LaTeX style file, and
%          IEEEbib.bst - IEEE bibliography style file.
% --------------------------------------------------------------------------
\documentclass{article}
\usepackage{spconf,amsmath,amssymb,amsthm,mathtools,graphicx,bm,mathtools,amsfonts,amscd,physics}
\usepackage[ruled,vlined,linesnumbered]{algorithm2e}
\usepackage{algpseudocode}
\newcommand{\inlineeqnum}{\refstepcounter{equation}~~\mbox{(\theequation)}}
\usepackage{xcolor}
\usepackage{mathtools}
\newcommand\Mycomb[2][^n]{\prescript{#1\mkern-0.5mu}{}C_{#2}}
\newtheorem{theorem}{Theorem}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{lemma}{Lemma}[section]
\def\x{{\mathbf x}}
\def\L{{\cal L}}
\title{Federated Algorithm With Bayesian Approach: OMNI-FEDGE}
\twoauthors
{Sai Anuroop Kesanapalli}
    {Department of Computer Science and Engineering\\
    Indian Institute of Technology Dharwad\\
    Karnataka, India - 580011}
 {B. N. Bharath}
    {Department of Electrical Engineering\\
    Indian Institute of Technology Dharwad\\
    Karnataka, India - 580011}

\begin{document}
    \section{Problem Setting} \label{sec:ps}
    \begin{itemize}
            \item There are $N$ edge-devices/nodes and one Federating Server (FS). 
            \item Let $\hat{\theta}_{i,t}$ denote the neural network of $i^{th}$ node at time $t$ and $\mathcal{L}_{i,t}(\theta_{j,t},z_{i,t})$ denote the loss of node $i$ at time $t$ using the neural network of node $j$ at time $t$, where $z_{i,t}$ denotes the data (or a batch of data points) seen by node $i$ at time $t$. 
            \item Let $\omega_{ij,t}$ denote the weight given by node $i$ to node $j$ based upon the loss incurred by node $i$ upon using the neural network of node $j$.
    \end{itemize}
    \section{Algorithm} \label{sec:algo}
    \textbf{for} $t\in\{1,\ldots,T\}$ \textbf{do}
    \begin{itemize}
            \item Update $\omega_{ij,t+1} \leftarrow \omega_{ij,t}e^{-\eta\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})}$, $\forall \ j\in\{1,\ldots,N\}$, where $\eta>0$ is a hyper-parameter and $\omega_{ij,1}=1\ \forall\ i,j\in\{1,\ldots,N\}$
            \item Compute $\theta_{i,t} = arg\min_{\theta}\mathcal{L}_{i,t}(\theta,z_{i,t})$ and broadcast to all nodes
            \item Update $\hat{\theta}_{i,t+1} \leftarrow \dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}\theta_{j,t}}{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}$ and broadcast to all nodes, where $\mathcal{S}_{t+1}\subseteq\{1,\ldots,N\}$ is randomly chosen and is of cardinality $K$
    \end{itemize}
    \section{Guarantees} \label{sec:guarantees}
    Let $\omega_{ij,t+1} = \omega_{ij,t}e^{-\eta\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})} = e^{-\eta L_{j,t}}$. Define $\Phi_{t}=\log{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}}$. Assume that $\mathcal{S}_{1}=\{1,\ldots,N\}$ and hence $\Phi_{1}=\log N$. Let $\bm{p}_{i,t}$ denote the distribution over $j=\{1,\ldots,N\}$ such that $p_{ij,t}=\dfrac{\omega_{ij,t}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}}$\\
    Consider $\mathbb{E}[\Phi_{t+1}-\Phi_{t}]$\\
    $=\mathbb{E}\Big[\log(\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1})-\log(\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t})\Big]$\\
    $=\mathbb{E}\Bigg[\log\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}}}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}}\dfrac{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}}\Bigg)\Bigg(\dfrac{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}}\Bigg)\Bigg(\dfrac{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}e^{-\eta\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}}}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}}\Bigg)\Bigg(\sum_{j\in\mathcal{S}_{t}}\Big(\dfrac{\omega_{ij,t}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t}}\Big)e^{-\eta\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})}}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}}\Bigg)\Bigg(\sum_{j\in\mathcal{S}_{t}}p_{ij,t}e^{-\eta\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})}}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}}\Bigg)\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$, where $X=-\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})$\\
    $=\mathbb{E}\Bigg[\log{\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}}\omega_{ij,t+1}}}\Bigg)}+\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$, where $X=-\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})$\\
    $=\mathbb{E}\Bigg[\log{\Bigg({\dfrac{\sum_{j\in\mathcal{S}_{t+1}\setminus\mathcal{S}_{t}}\omega_{ij,t+1}+\sum_{j\in\mathcal{S}_{t+1}\cap\mathcal{S}_{t}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}\setminus\mathcal{S}_{t+1}}\omega_{ij,t+1}+\sum_{j\in\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}\omega_{ij,t+1}}}\Bigg)}+\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{{\dfrac{\Bigg(\dfrac{\sum_{j\in\mathcal{S}_{t+1}\setminus\mathcal{S}_{t}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t+1}\cap\mathcal{S}_{t}}\omega_{ij,t+1}}\Bigg)+1}{\Bigg(\dfrac{\sum_{j\in\mathcal{S}_{t}\setminus\mathcal{S}_{t+1}}\omega_{ij,t+1}}{\sum_{j\in\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}\omega_{ij,t+1}}\Bigg)+1}}}+\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{{\dfrac{\Bigg(\dfrac{\sum_{j\in\mathcal{S}_{t+1}\setminus\mathcal{S}_{t}}e^{-\eta L_{j,t}}}{\sum_{j\in\mathcal{S}_{t+1}\cap\mathcal{S}_{t}}e^{-\eta L_{j,t}}}\Bigg)+1}{\Bigg(\dfrac{\sum_{j\in\mathcal{S}_{t}\setminus\mathcal{S}_{t+1}}e^{-\eta L_{j,t}}}{\sum_{j\in\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}e^{-\eta L_{j,t}}}\Bigg)+1}}}+\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$\\
    $\leq\mathbb{E}\Bigg[\log{{\dfrac{\Bigg(\dfrac{\abs{\mathcal{S}_{t+1}\setminus\mathcal{S}_{t}}e^{-\eta L_{min,t}}}{\abs{\mathcal{S}_{t+1}\cap\mathcal{S}_{t}}e^{-\eta L_{max,t}}}\Bigg)+1}{\Bigg(\dfrac{\abs{\mathcal{S}_{t}\setminus\mathcal{S}_{t+1}}e^{-\eta L_{max,t}}}{\abs{\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}e^{-\eta L_{min,t}}}\Bigg)+1}}}+\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{{\dfrac{\Bigg(\dfrac{\abs{\mathcal{S}_{t+1}\setminus\mathcal{S}_{t}}}{\abs{\mathcal{S}_{t+1}\cap\mathcal{S}_{t}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\dfrac{\abs{\mathcal{S}_{t}\setminus\mathcal{S}_{t+1}}}{\abs{\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$\\
    $=\mathbb{E}\Bigg[\log{{\dfrac{\Bigg(\dfrac{\abs{\mathcal{S}_{t+1}\setminus\mathcal{S}_{t}}}{\abs{\mathcal{S}_{t+1}\cap\mathcal{S}_{t}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\dfrac{\abs{\mathcal{S}_{t}\setminus\mathcal{S}_{t+1}}}{\abs{\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}\Bigg]+\mathbb{E}\Bigg[\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Bigg]$\\
    $\leq\log{{\dfrac{\Bigg(\mathbb{E}\Big[\dfrac{\abs{\mathcal{S}_{t+1}\setminus\mathcal{S}_{t}}}{\abs{\mathcal{S}_{t+1}\cap\mathcal{S}_{t}}}\Big]e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\mathbb{E}\Big[\dfrac{\abs{\mathcal{S}_{t}\setminus\mathcal{S}_{t+1}}}{\abs{\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}}\Big]e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\mathbb{E}\Big[\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Big]$, by Jensen's inequality\\
    $=\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big)\mathbb{P}\Big[\abs{\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}=m\Big]e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big)\mathbb{P}\Big[\abs{\mathcal{S}_{t}\cap\mathcal{S}_{t+1}}=m\Big]e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\mathbb{E}\Big[\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Big]$, since $\abs{\mathcal{S}_{t+1}}=\abs{\mathcal{S}_{t}}=K$\\
    $=\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\mathbb{E}\Big[\log{\Bigg(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta X}]}\Bigg)\Big]$\\
    $=\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\mathbb{E}\Big[\log{(\mathbb{E}_{\bm{p}_{i,t}}[e^{\eta(X-\mathbb{E}_{\bm{p}_{i,t}}[X])+\eta\mathbb{E}_{\bm{p}_{i,t}}[X]}])}\Big]$\\
    $\leq\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta^{2}}{8}+\eta\mathbb{E}\Big[\mathbb{E}_{\bm{p}_{i,t}}[X]\Big]$, by Hoeffding's Lemma\\
    $=\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta^{2}}{8}-\eta\mathbb{E}\Big[\mathbb{E}_{\bm{p}_{i,t}}[\mathcal{L}_{i,t}(\hat{\theta}_{j,t},z_{i,t})]\Big]$\\
    $\leq\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta^{2}}{8}-\eta\mathbb{E}\Big[\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})\Big]$, by convexity of loss function in the first argument\\
    So we have the upper bound as,\\
    $\mathbb{E}[\Phi_{T+1}-\Phi_{T}]\leq\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta^{2}T}{8}-\eta\mathbb{E}[\sum_{t=1}^{T}\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})]$,\\
    i.e.,\\
    $\mathbb{E}[\Phi_{T+1}]-\mathbb{E}[\Phi_{T}]\leq\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta^{2}T}{8}-\eta\mathbb{E}[\sum_{t=1}^{T}\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})]$\\
    Again consider $\mathbb{E}[\Phi_{T+1}]-\mathbb{E}[\Phi_{1}]$\\
    $=\mathbb{E}[\log{(\sum_{j\in\mathcal{S}_{T+1}}\omega_{ij,T+1})}]-\log{N}$\\
    $=\mathbb{E}[\log{(\sum_{j\in\mathcal{S}_{T+1}}e^{-\eta L_{j,T}})}]-\log{N}$\\
    $\geq\mathbb{E}[\log{(\max_{j\in\mathcal{S}_{T+1}}e^{-\eta L_{j,T}})}]-\log{N}$\\
    $=-\eta\mathbb{E}[\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})]-\log{N}$\\
    $=-\eta\mathbb{E}[\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})]-\eta\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]-\log{N}$\\
    $=-\eta\Big[\mathbb{P}[arg\min_{j\in\{1,\ldots,N\}}(L_{j,T})\in\mathcal{S}_{T+1}][\min_{j\in\{1,\ldots,N\}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})]+\mathbb{P}(arg\min_{j\in\{1,\ldots,N\}}(L_{j,T})\not\in\mathcal{S}_{T+1}][\min_{j\in\mathcal{S}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})]\Big]-\eta\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]-\log{N}$\\
    $=-\eta\Bigg(1-\dfrac{\Mycomb[N-1]{K-1}}{\Mycomb[N]{K}}\Bigg)\Big[\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\Big]-\eta\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]-\log{N}$, where $K=\abs{\mathcal{S}_{T+1}}$\\
    $=-\eta\Bigg(1-\dfrac{K}{N}\Bigg)\Big[\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\Big]-\eta\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]-\log{N}$, where $K=\abs{\mathcal{S}_{T+1}}$\\
    So we have the lower bound as, $\mathbb{E}[\Phi_{T+1}]-\mathbb{E}[\Phi_{T}]\geq-\eta\Bigg(1-\dfrac{K}{N}\Bigg)\Big[\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\Big]-\eta\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]-\log{N}$\\
    Combining both the bounds yields,\\
    $-\eta\Bigg(1-\dfrac{K}{N}\Bigg)\Big[\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\Big]-\eta\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]-\log{N}\leq$\\
    $\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta^{2}T}{8}-\eta\mathbb{E}[\sum_{t=1}^{T}\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})]$\\
    On re-arranging terms, we get\\
    $\mathbb{E}[\sum_{t=1}^{T}\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})]-\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]\leq$\\
    $\dfrac{1}{\eta}\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta T}{8}+\dfrac{\log{N}}{\eta}+\Bigg(1-\dfrac{K}{N}\Bigg)\Big[\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\Big]$\\
    i.e.,\\
    $\mathbb{E}[\sum_{t=1}^{T}\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})]-\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]\leq$\\
    $\dfrac{1}{\eta}\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}+\dfrac{\eta T}{8}+\dfrac{\log{N}}{\eta}+\Bigg(1-\dfrac{K}{N}\Bigg)L_{T}$,\\ where $\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\leq L_{T}$\\
    Let us further upper bound the following term\\
    $\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}$\\
    Observe that $\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}=\prod\limits_{i=1}^{m}\dfrac{K-i+1}{N-i+1}$ and as $0\leq K\leq N$, we have $\prod\limits_{i=1}^{m}\dfrac{K-i+1}{N-i+1}\leq1\ \forall\ m\in\{1,\ldots K-1\}$\\
    This means $\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}\leq1\ \forall\ m\in\{1,\ldots K-1\}$\\
    So,\\
    $\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}$\\
    $\leq\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big)$\\
    $=\sum\limits_{m=1}^{K-1}\Big(\dfrac{K}{m}-1\Big)$\\
    $=K\sum\limits_{m=1}^{K-1}\Big(\dfrac{1}{m}\Big)-(K-1)$\\
    $\leq K\sum\limits_{m=1}^{K-1}\Big(1\Big)-(K-1)$\\
    $=K(K-1)-(K-1)$\\
    $=(K-1)^{2}$\\
    We thus have, $\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}\leq(K-1)^{2}$\\
    Also, observe that $\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}=\prod\limits_{i=1}^{m}\dfrac{K-i+1}{N-i+1}$ and as $0\leq K\leq N$, we have $\prod\limits_{i=1}^{m}\dfrac{K-i+1}{N-i+1}>0\ \forall\ m\in\{1,\ldots K-1\}$\\
    This means $\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}>0\ \forall\ m\in\{1,\ldots K-1\}$\\
    So,\\
    $\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}$\\
    $>\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big).0$\\
    $=0$\\
    We thus have, $\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}>0$\\
    Using these results in $\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}$, we get\\
    $\sum_{t=1}^{T}\log{{\dfrac{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{-\eta(L_{min,t}-L_{max,t})}\Bigg)+1}{\Bigg(\sum\limits_{m=1}^{K-1}\Big(\dfrac{K-m}{m}\Big){\dfrac{\Mycomb[N-m]{K-m}}{\Mycomb[N]{K}}}e^{\eta(L_{min,t}-L_{max,t})}\Bigg)+1}}}<\sum_{t=1}^{T}\log\Big({(K-1)^{2}e^{-\eta(L_{min,t}-L_{max,t})}+1}\Big)$\\
    So we have,\\
    $\mathbb{E}[\sum_{t=1}^{T}\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})]-\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]<$\\
    $\dfrac{1}{\eta}\sum_{t=1}^{T}\log\Big({(K-1)^{2}e^{-\eta(L_{min,t}-L_{max,t})}+1}\Big)+\dfrac{\eta T}{8}+\dfrac{\log{N}}{\eta}+\Bigg(1-\dfrac{K}{N}\Bigg)L_{T}$,\\ where $\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\leq L_{T}$\\
    Further, if we allow $(K-1)^{2}e^{-\eta(L_{min,t}-L_{max,t})}+1\approx(K-1)^{2}e^{-\eta(L_{min,t}-L_{max,t})}=e^{-\eta(L_{min,t}-L_{max,t})+2\log{(K-1)}}$, then\\
    $\dfrac{1}{\eta}\sum_{t=1}^{T}\log\Big({(K-1)^{2}e^{-\eta(L_{min,t}-L_{max,t})}+1}\Big)\approx-\sum_{t=1}^{T}\eta(L_{min,t}-L_{max,t})+\dfrac{2T}{\eta}\log{(K-1)}$\\
    Finally, we have\\~\\
    $\mathbb{E}[\sum_{t=1}^{T}\mathcal{L}_{i,t}(\mathbb{E}_{\bm{p}_{i,t}}[\hat{\theta}_{j,t}],z_{i,t})]-\mathbb{E}[\min_{j\in\{1,\ldots,N\}}(L_{j,T})]\lessapprox$\\
    $-\sum_{t=1}^{T}\eta(L_{min,t}-L_{max,t})+\dfrac{2T}{\eta}\log{(K-1)}+\dfrac{\eta T}{8}+\dfrac{\log{N}}{\eta}+\Bigg(1-\dfrac{K}{N}\Bigg)L_{T}$,\\~\\ where $\min_{j\in\mathcal{S}_{T+1}}(L_{j,T})-\min_{j\in\{1,\ldots,N\}}(L_{j,T})\leq L_{T}$\\

\end{document}